{"file":"p-BfovIwRd.js","mappings":"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","names":["__stencil_proxyCustomElement","HTMLElement"],"sources":["src/services/application-flags/is-outsystems-app.ts","src/components/common/render-error.tsx","src/components/cps-global-menu/menu-config/helpers/is-context-match.ts","src/components/cps-global-menu/menu-config/helpers/should-show-link.ts","src/components/cps-global-menu/menu-config/helpers/replace-tags-in-string.ts","src/components/cps-global-menu/menu-config/helpers/map-link-config.ts","src/components/cps-global-menu/menu-config/helpers/group-links-by-level.ts","../cps-global-os-handover/dist/index.js","src/components/cps-global-menu/menu-config/menu-config.ts","src/components/cps-global-menu/cps-global-menu.scss?tag=cps-global-menu","src/components/cps-global-menu/cps-global-menu.tsx"],"sourcesContent":["export const isOutSystemsApp = ({ location: { href } }: { location: { href: string } }) => {\n  try {\n    const url = href;\n    if (!url) {\n      return false;\n    }\n    const resolvedUrl = url.toLowerCase();\n    return resolvedUrl.toLowerCase().startsWith(\"http\") && new URL(resolvedUrl).hostname.endsWith(\".outsystemsenterprise.com\");\n  } catch (err) {\n    return false;\n  }\n};\n","import { h } from \"@stencil/core\";\n\nexport const renderError = (error: Error | string) => {\n  const coercedError = error instanceof Error ? error : new Error(error);\n  return <div class=\"level-1 background-grey error\">{coercedError.toString()}</div>;\n};\n","export const isContextMatch = (contextStringA: string = \"\", contextStringB: string = \"\") =>\n  contextStringA.split(\" \").some(contextValue => contextStringB.split(\" \").includes(contextValue));\n","import { Link } from \"cps-global-configuration\";\nimport { isContextMatch } from \"./is-context-match\";\n\nexport const shouldShowLink =\n  (contexts: string) =>\n  ({ visibleContexts }: Link) =>\n    !visibleContexts || isContextMatch(contexts, visibleContexts);\n","export const replaceTagsInString = (source: string, tags: { [key: string]: string }) =>\n  Object.keys(tags).reduce((acc, curr) => acc.replace(new RegExp(`{${curr}}`, \"g\"), tags[curr]), source);\n","import { Link } from \"cps-global-configuration\";\nimport { isContextMatch } from \"./is-context-match\";\nimport { replaceTagsInString } from \"./replace-tags-in-string\";\n\nexport type MapLinkConfigResult = ReturnType<ReturnType<typeof mapLinkConfig>>;\n\ntype MapLinkConfigParams = { contexts: string; tags: Record<string, string>; handoverAdapter?: ((targetUrl: string) => string) | undefined };\n\nexport const mapLinkConfig =\n  ({ contexts, tags, handoverAdapter }: MapLinkConfigParams) =>\n  ({ label, href, level, activeContexts, openInNewTab, preferEventNavigationContexts }: Link) => {\n    const processedHref = replaceTagsInString(href, tags);\n\n    return {\n      label,\n      level,\n      openInNewTab,\n      href: handoverAdapter ? handoverAdapter(processedHref) : processedHref,\n      selected: isContextMatch(contexts, activeContexts),\n      preferEventNavigation: isContextMatch(contexts, preferEventNavigationContexts),\n    };\n  };\n","import { MapLinkConfigResult } from \"./map-link-config\";\n\nexport type GroupedLink = Omit<MapLinkConfigResult, \"level\"> & { ariaSelected?: true };\n\nexport const groupLinksByLevel = (links: MapLinkConfigResult[]): GroupedLink[][] => {\n  const highestSelectedLevel = Math.max(...links.filter(({ selected }) => selected).map(({ level }) => level));\n  const result: GroupedLink[][] = [];\n\n  for (const { level, ...rest } of links) {\n    if (!result[level]) {\n      result[level] = [];\n    }\n    result[level].push({ ...rest, ariaSelected: level === highestSelectedLevel && rest.selected ? true : undefined });\n  }\n\n  return result;\n};\n","const paramKeys = {\n    STAGE: \"stage\",\n    R: \"r\"};\nconst stages = {\n    OS_OUTBOUND: \"os-outbound\"};\nconst localStorageKeys = {\n    WMA_JSON: \"$OS_Users$WorkManagementApp$ClientVars$JSONString\",\n    WMA_COOKIES: \"$OS_Users$WorkManagementApp$ClientVars$Cookies\",\n    CASE_REVIEW_JSON: \"$OS_Users$CaseReview$ClientVars$CmsAuthValues\",\n    CASE_REVIEW_COOKIES: \"$OS_Users$CaseReview$ClientVars$Cookies\",\n};\nconst setParams = (url, params) => Object.entries(params).forEach(([key, value]) => url.searchParams.set(key, value));\nconst createUrl = (baseUrl, params) => {\n    const url = new URL(baseUrl);\n    setParams(url, params);\n    return url;\n};\n/** Used to create a navigation link that utilises OS auth handover. */\nconst createOutboundUrl = ({ handoverUrl, targetUrl, }) => {\n    const nextUrl = createUrl(handoverUrl, {\n        [paramKeys.STAGE]: stages.OS_OUTBOUND,\n        [paramKeys.R]: targetUrl,\n    });\n    return nextUrl.toString();\n};\nconst isOSAuthMisaligned = () => {\n    const { WMA_JSON, WMA_COOKIES, CASE_REVIEW_JSON, CASE_REVIEW_COOKIES } = localStorageKeys;\n    return (localStorage[WMA_COOKIES] !== localStorage[CASE_REVIEW_COOKIES] ||\n        localStorage[WMA_JSON] !== localStorage[CASE_REVIEW_JSON]);\n};\n\nexport { createOutboundUrl, isOSAuthMisaligned };\n//# sourceMappingURL=index.js.map\n","import { shouldShowLink } from \"./helpers/should-show-link\";\nimport { mapLinkConfig } from \"./helpers/map-link-config\";\nimport { GroupedLink, groupLinksByLevel } from \"./helpers/group-links-by-level\";\nimport { isOutSystemsApp } from \"../../../services/application-flags/is-outsystems-app\";\nimport { createOutboundUrl } from \"cps-global-os-handover\";\nimport { withLogging } from \"../../../logging/with-logging\";\nimport { KnownState } from \"../../../store/store\";\n\nexport type MenuConfigResult =\n  | {\n      status: \"ok\";\n      links: GroupedLink[][];\n    }\n  | {\n      status: \"error\";\n      error: Error;\n    };\n\nconst menuConfigInternal = ({\n  context,\n  flags: { isOutSystems },\n  config: { OS_HANDOVER_URL, LINKS },\n  tags: tagsFromDom,\n}: Pick<KnownState, \"context\" | \"config\" | \"tags\" | \"flags\">): MenuConfigResult => {\n  if (!context?.found) {\n    return { status: \"error\", error: new Error(\"No context found for this URL.\") };\n  }\n  const { contexts, tags } = context;\n\n  const handoverAdapter = isOutSystems\n    ? undefined\n    : // If we are outside of OutSystems and a link is pointing to OutSystems then we need to go\n      //  via the auth handover endpoint to ensure OS has CMS auth\n      (targetUrl: string) => {\n        const shouldGoViaAuthHandover = isOutSystemsApp({ location: { href: targetUrl } }) && OS_HANDOVER_URL;\n        return shouldGoViaAuthHandover ? createOutboundUrl({ handoverUrl: OS_HANDOVER_URL, targetUrl }) : targetUrl;\n      };\n  const links = LINKS.filter(shouldShowLink(contexts)).map(mapLinkConfig({ contexts, tags: { ...tags, ...tagsFromDom }, handoverAdapter }));\n  return { status: \"ok\", links: groupLinksByLevel(links) };\n};\n\nexport const menuConfig = withLogging(\"menuConfig\", menuConfigInternal);\n","@import \"../common/common.scss\";\n\n:host {\n  display: block;\n}\n\n@mixin link-colours {\n  color: $govuk-error-colour;\n\n  &:hover,\n  &:visited:hover {\n    color: $govuk-link-hover-colour;\n  }\n\n  &:focus,\n  &:visited:focus {\n    color: $govuk-link-active-colour;\n  }\n\n  &:visited {\n    color: $govuk-brand-colour;\n  }\n\n  display: none;\n}\n\na.govuk-link {\n  @include link-colours();\n  @include govuk-font($size: 19);\n  text-decoration: none;\n}\n\n@mixin horizontal-list {\n  list-style-type: none;\n  margin: 0;\n  padding: 0;\n  height: $level-height;\n  display: flex;\n  align-items: center;\n  & > li {\n    float: left;\n    box-sizing: border-box;\n  }\n}\n\n@mixin border-bottom-active-link {\n  li.selected a,\n  li.selected button {\n    border-bottom: 3px solid $govuk-link-colour;\n  }\n}\n\n.level {\n  height: $level-height;\n  ul {\n    @include horizontal-list();\n    @include border-bottom-active-link();\n    margin-left: -1 * $level-height / 5;\n\n    nav-link {\n      align-self: stretch;\n\n      li {\n        height: 100%;\n\n        a {\n          display: inline-block;\n          padding: ($level-height / 5 + 0.05) 0;\n          margin: 0 $level-height / 5;\n        }\n\n        button {\n          display: inline-block;\n          padding: ($level-height / 5 + 0.05) 0;\n          margin: 0 $level-height / 5;\n        }\n      }\n    }\n    .selected {\n      position: relative;\n    }\n  }\n}\n\n.level-1 {\n  nav-link.survey-link {\n    margin-left: auto;\n    margin-right: 0;\n  }\n\n  a,\n  button {\n    font-weight: bold;\n  }\n}\n\n.level-2 {\n  .selected {\n    a,\n    button {\n      font-weight: bold;\n    }\n  }\n}\n\na.disabled {\n  color: $govuk-border-colour;\n  pointer-events: none;\n  cursor: default;\n}\n\n.linkButton {\n  @include link-colours();\n  margin: 0.125rem;\n  display: inline;\n  background: transparent;\n  border-width: 0;\n  cursor: pointer;\n  font-size: 1.187rem;\n  width: fit-content;\n  color: $govuk-link-colour;\n  @include govuk-font($size: 19);\n  padding: 0;\n  &:focus {\n    background-color: $govuk-focus-colour;\n    box-shadow: 0 -2px $govuk-focus-colour, 0 4px $govuk-text-colour;\n    outline: 0.1875rem solid transparent;\n  }\n  // &:focus,\n  // &:hover {\n  //   color: $govuk-link-active-colour;\n  // }\n}\n","import { Component, h, Fragment } from \"@stencil/core\";\nimport { menuConfig } from \"./menu-config/menu-config\";\nimport { readyState } from \"../../store/store\";\nimport { FLAGS } from \"../../feature-flags/feature-flags\";\nimport { renderError } from \"../common/render-error\";\nimport { _console } from \"../../logging/_console\";\nimport { WithLogging } from \"../../logging/WithLogging\";\n@Component({\n  tag: \"cps-global-menu\",\n  styleUrl: \"cps-global-menu.scss\",\n  shadow: false,\n})\nexport class CpsGlobalMenu {\n  @WithLogging(\"CpsGlobalMenu\")\n  render() {\n    const state = readyState(\"config\", \"auth\", \"tags\", \"flags\", \"context\");\n    if (!state) {\n      return null; // don't show menu until we are ready\n    }\n\n    if (!FLAGS.shouldShowMenu(state)) {\n      return null;\n    }\n\n    const menu = menuConfig(state);\n\n    if (menu.status === \"error\") {\n      return renderError(menu.error);\n    }\n\n    const {\n      links: [level1Links, level2Links],\n    } = menu;\n\n    // Design decision: if there are no links (we only need to check for top-level links)\n    //  then we will take this as an address where the menu should not be shown\n    if (!level1Links.length) {\n      return null;\n    }\n\n    const surveyLink = FLAGS.surveyLink(state);\n\n    const classes = FLAGS.shouldShowGovUkRebrand(state)\n      ? { flag: \"govuk-template--rebranded\", level1Background: \"background-light-blue\", divider: \"background-divider-blue\" }\n      : { flag: \"\", level1Background: \"background-grey\", divider: \"background-divider\" };\n\n    return (\n      <div class={classes.flag}>\n        <nav class={`level level-1 ${classes.level1Background}`} aria-label=\"Menu\" data-testid=\"menu-level-1\">\n          <ul>\n            {level1Links?.map(link => (\n              <nav-link {...link}></nav-link>\n            ))}\n            {surveyLink.showLink && <nav-link openInNewTab class=\"survey-link\" label=\"Give feedback\" href={surveyLink.url}></nav-link>}\n          </ul>\n        </nav>\n\n        <div class={classes.divider}></div>\n\n        {!!level2Links?.length && (\n          <>\n            <nav class=\"level level-2 background-white\" aria-label=\"Sub-menu\" data-testid=\"menu-level-2\">\n              <ul>\n                {level2Links.map(link => (\n                  <nav-link {...link}></nav-link>\n                ))}\n              </ul>\n            </nav>\n            <div class={classes.divider}></div>\n          </>\n        )}\n      </div>\n    );\n  }\n}\n"],"version":3}